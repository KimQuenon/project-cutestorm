{% extends 'base.html.twig' %}

{% block title %}Top Liked Posts{% endblock %}

{% block body %}
<div class="text-center my-5">
    <h1 class="display-4">Top 3 Most Liked Posts</h1>
</div>

<div class="container">
    <div class="podium-row row justify-content-center text-center">
        {% for post in topLikedPosts %}
            {% set rank = loop.index %}
            {% set podiumClass = rank == 1 ? 'bg-gold' : (rank == 2 ? 'bg-silver' : 'bg-bronze') %}
            {% set order = rank == 1 ? 'order-2' : (rank == 2 ? 'order-1' : 'order-3') %}
            {% set height = rank == 1 ? 'h-100' : (rank == 2 ? 'h-75' : 'h-50') %}
            
            <div class="col-md-4 d-flex justify-content-between align-items-end {{ order }}">
                <div class="card {{ podiumClass }} {{ height }} w-100">
                    <div class="card-body">
                        <h3 class="card-title">{{ rank }}. {{ post.title }}</h3>
                        by <a href="{{path('profile_show', {'slug': post.author.slug})}}" class="card-subtitle mb-2 text-muted">{{ post.author.pseudo }}</a>
                        <p class="card-text">{{ post.likes|length }} Likes</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>


<div class="text-center my-5">
    <h1 class="display-4">Top 3 Most Commented Posts</h1>
</div>

<div class="container">
    <div class="podium-row row justify-content-center text-center">
        {% for post in topCommentedPosts %}
            {% set rank = loop.index %}
            {% set podiumClass = rank == 1 ? 'bg-gold' : (rank == 2 ? 'bg-silver' : 'bg-bronze') %}
            {% set order = rank == 1 ? 'order-2' : (rank == 2 ? 'order-1' : 'order-3') %}
            {% set height = rank == 1 ? 'h-100' : (rank == 2 ? 'h-75' : 'h-50') %}
            
            <div class="col-md-4 d-flex justify-content-between align-items-end {{ order }}">
                <div class="card {{ podiumClass }} {{ height }} w-100">
                    <div class="card-body">
                        <h3 class="card-title">{{ rank }}. {{ post.title }}</h3>
                        by <a href="{{ path('profile_show', {'slug': post.author.slug}) }}" class="card-subtitle mb-2 text-muted">{{ post.author.pseudo }}</a>
                        <p class="card-text">{{ post.comments|length }} Comments</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<div class="text-center my-5">
    <h1 class="display-4">Top 3 Most Liked Users</h1>
</div>

<div class="container">
    <div class="podium-row row justify-content-center text-center">
        {% for user in topLikedUsers %}
            {% set rank = loop.index %}
            {% set podiumClass = rank == 1 ? 'bg-gold' : (rank == 2 ? 'bg-silver' : 'bg-bronze') %}
            {% set order = rank == 1 ? 'order-2' : (rank == 2 ? 'order-1' : 'order-3') %}
            {% set height = rank == 1 ? 'h-100' : (rank == 2 ? 'h-75' : 'h-50') %}
            
            <div class="col-md-4 d-flex justify-content-between align-items-end {{ order }}">
                <div class="card {{ podiumClass }} {{ height }} w-100">
                    <div class="card-body">
                        <h3 class="card-title">{{ rank }}. {{ user.pseudo }}</h3>
                         <a href="{{ path('profile_show', {'slug': user.slug}) }}" class="card-subtitle mb-2 text-muted">{{ user.pseudo }}</a>
                        <p class="card-text">{{ user.total_likes }} Likes</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

<div class="text-center my-5">
    <h1 class="display-4">Top 3 Most Prolific Users</h1>
</div>

<div class="container">
    <div class="podium-row row justify-content-center text-center">
        {% for user in topCreators %}
            {% set rank = loop.index %}
            {% set podiumClass = rank == 1 ? 'bg-gold' : (rank == 2 ? 'bg-silver' : 'bg-bronze') %}
            {% set order = rank == 1 ? 'order-2' : (rank == 2 ? 'order-1' : 'order-3') %}
            {% set height = rank == 1 ? 'h-100' : (rank == 2 ? 'h-75' : 'h-50') %}
            
            <div class="col-md-4 d-flex justify-content-between align-items-end {{ order }}">
                <div class="card {{ podiumClass }} {{ height }} w-100">
                    <div class="card-body">
                        <h3 class="card-title">{{ rank }}. {{ user.pseudo }}</h3>
                        <a href="{{ path('profile_show', {'slug': user.slug}) }}" class="card-subtitle mb-2 text-muted">{{ user.pseudo }}</a>
                        <p class="card-text">{{ user.post_count }} Posts</p>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
</div>

{% endblock %}
